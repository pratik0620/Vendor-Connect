
// Language translations
const translations = {
    en: {
        login_title: "Login to VendorConnect",
        username: "Username",
        password: "Password",
        select_role: "Select Role",
        choose_role: "Choose role...",
        vendor: "Vendor",
        supplier: "Supplier",
        login_btn: "Login",
        demo_note: "This is a demo. Any username/password will work.",
        welcome: "Welcome",
        vendor_dashboard: "Vendor Dashboard",
        supplier_dashboard: "Supplier Dashboard",
        refresh: "Refresh",
        logout: "Logout",
        inventory_status: "Inventory Status",
        update_inventory: "Update Inventory",
        product: "Product",
        quantity: "Quantity",
        status: "Status",
        actions: "Actions",
        price_comparison: "Price Comparison",
        item: "Item",
        market_price: "Market Price",
        best_supplier: "Best Supplier",
        best_price: "Best Price",
        nearby_suppliers: "Nearby Suppliers",
        notifications: "Notifications",
        group_purchases: "Group Purchases",
        join: "Join",
        autopay_setup: "Autopay Setup",
        payment_methods: "Payment Methods",
        bank_transfer: "Bank Transfer",
        credit_card: "Credit Card",
        upi: "UPI",
        autopay_settings: "Autopay Settings",
        min_amount: "Minimum Order Amount",
        payment_day: "Payment Day",
        first_day: "First day of month",
        fifteenth_day: "15th of month",
        last_day: "Last day of month",
        product_catalog: "Product Catalog",
        add_product: "Add Product",
        price: "Price (₹/kg)",
        freshness: "Freshness",
        hygiene_rating: "Hygiene Rating",
        reviews: "Reviews & Ratings",
        total_reviews: "total reviews",
        vendor_orders: "Vendor Orders",
        pending: "Pending",
        fulfilled: "Fulfilled",
        group_orders: "Group Orders",
        vendor_name: "Vendor Name",
        items: "Items",
        amount: "Amount",
        order_date: "Order Date",
        delivery_date: "Delivery Date",
        profile: "Profile & Business Details",
        business_name: "Business Name",
        contact_number: "Contact Number",
        delivery_areas: "Delivery Areas",
        business_hours: "Business Hours",
        hygiene_practices: "Hygiene Practices",
        update_profile: "Update Profile",
        add_new_product: "Add New Product",
        product_name: "Product Name",
        price_per_kg: "Price per kg (₹)",
        fresh: "Fresh (< 24 hours)",
        good: "Good (1-3 days)",
        regular: "Regular (3-7 days)",
        available_quantity: "Available Quantity (kg)",
        cancel: "Cancel",
        save_product: "Save Product",
        low_stock: "Low Stock",
        ok_stock: "OK",
        order: "Order",
        distance: "Distance",
        view_products: "View Products",
        price_drop: "Price Drop",
        new_supplier_offer: "New Supplier Offer",
        govt_scheme: "Government Scheme",
        items_needed: "Items Needed",
        vendors_joined: "Vendors Joined",
        join_group: "Join Group",
        verify: "Verify",
        fulfill: "Fulfill",
        complete: "Complete",
        review_from: "Review from",
        days_ago: "days ago",
        group_purchase_opportunity: "Group Purchase Opportunity",
        ordered_on: "Ordered on",
        delivered_on: "Delivered on",
        delivery_pending: "Delivery Pending",
        new_order: "New Order",
        repeat_order: "Repeat Order",
        vendor_comment: "Vendor Comment",
        add_to_cart: "Add to Cart",
        buy_now: "Buy Now"
    },
    hi: {
        login_title: "वेंडरकनेक्ट में लॉगिन करें",
        username: "यूज़रनेम",
        password: "पासवर्ड",
        select_role: "भूमिका चुनें",
        choose_role: "भूमिका चुनें...",
        vendor: "विक्रेता",
        supplier: "आपूर्तिकर्ता",
        login_btn: "लॉगिन करें",
        demo_note: "यह एक डेमो है। कोई भी यूज़रनेम/पासवर्ड काम करेगा।",
        welcome: "स्वागत है",
        vendor_dashboard: "विक्रेता डैशबोर्ड",
        supplier_dashboard: "आपूर्तिकर्ता डैशबोर्ड",
        refresh: "रीफ्रेश करें",
        logout: "लॉगआउट करें",
        inventory_status: "इन्वेंटरी स्थिति",
        update_inventory: "इन्वेंटरी अपडेट करें",
        product: "उत्पाद",
        quantity: "मात्रा",
        status: "स्थिति",
        actions: "क्रियाएँ",
        price_comparison: "मूल्य तुलना",
        item: "वस्तु",
        market_price: "बाजार मूल्य",
        best_supplier: "सर्वोत्तम आपूर्तिकर्ता",
        best_price: "सर्वोत्तम मूल्य",
        nearby_suppliers: "आस-पास के आपूर्तिकर्ता",
        notifications: "सूचनाएँ",
        group_purchases: "समूह खरीदारी",
        join: "शामिल हों",
        autopay_setup: "ऑटोपे सेटअप",
        payment_methods: "भुगतान विधि",
        bank_transfer: "बैंक ट्रांसफर",
        credit_card: "क्रेडिट कार्ड",
        upi: "यूपीआई",
        autopay_settings: "ऑटोपे सेटिंग्स",
        min_amount: "न्यूनतम ऑर्डर राशि",
        payment_day: "भुगतान दिन",
        first_day: "महीने का पहला दिन",
        fifteenth_day: "महीने का 15वां दिन",
        last_day: "महीने का अंतिम दिन",
        product_catalog: "उत्पाद सूची",
        add_product: "उत्पाद जोड़ें",
        price: "मूल्य (₹/किलो)",
        freshness: "ताजगी",
        hygiene_rating: "स्वच्छता रेटिंग",
        reviews: "समीक्षाएँ और रेटिंग",
        total_reviews: "कुल समीक्षाएँ",
        vendor_orders: "विक्रेता के ऑर्डर",
        pending: "लंबित",
        fulfilled: "पूरे किए गए",
        group_orders: "समूह ऑर्डर",
        vendor_name: "विक्रेता का नाम",
        items: "वस्तुएँ",
        amount: "राशि",
        order_date: "ऑर्डर तिथि",
        delivery_date: "डिलीवरी तिथि",
        profile: "प्रोफाइल और व्यापार विवरण",
        business_name: "व्यापार का नाम",
        contact_number: "संपर्क नंबर",
        delivery_areas: "डिलीवरी क्षेत्र",
        business_hours: "व्यापार के घंटे",
        hygiene_practices: "स्वच्छता अभ्यास",
        update_profile: "प्रोफाइल अपडेट करें",
        add_new_product: "नया उत्पाद जोड़ें",
        product_name: "उत्पाद का नाम",
        price_per_kg: "प्रति किलो मूल्य (₹)",
        fresh: "ताजा (< 24 घंटे)",
        good: "अच्छा (1-3 दिन)",
        regular: "साधारण (3-7 दिन)",
        available_quantity: "उपलब्ध मात्रा (किलो)",
        cancel: "रद्द करें",
        save_product: "उत्पाद सहेजें",
        low_stock: "कम स्टॉक",
        ok_stock: "ठीक है",
        order: "ऑर्डर",
        distance: "दूरी",
        view_products: "उत्पाद देखें",
        price_drop: "मूल्य गिरावट",
        new_supplier_offer: "नए आपूर्तिकर्ता का प्रस्ताव",
        govt_scheme: "सरकारी योजना",
        items_needed: "आवश्यक वस्तुएँ",
        vendors_joined: "शामिल हुए विक्रेता",
        join_group: "समूह में शामिल हों",
        verify: "सत्यापित करें",
        fulfill: "पूरा करें",
        complete: "पूर्ण",
        review_from: "से समीक्षा",
        days_ago: "दिन पहले",
        group_purchase_opportunity: "समूह खरीदारी का अवसर",
        ordered_on: "पर ऑर्डर किया",
        delivered_on: "पर वितरित",
        delivery_pending: "डिलीवरी लंबित",
        new_order: "नया ऑर्डर",
        repeat_order: "दोहराया गया ऑर्डर",
        vendor_comment: "विक्रेता टिप्पणी",
        add_to_cart: "कार्ट में जोड़ें",
        buy_now: "अभी खरीदें"
    },
    mr: {
        login_title: "व्हेंडरकनेक्टमध्ये लॉगिन करा",
        username: "युजरनेम",
        password: "पासवर्ड",
        select_role: "भूमिका निवडा",
        choose_role: "भूमिका निवडा...",
        vendor: "विक्रेता",
        supplier: "पुरवठादार",
        login_btn: "लॉगिन करा",
        demo_note: "हा एक डेमो आहे. कोणतेही युजरनेम/पासवर्ड चालेल.",
        welcome: "स्वागत आहे",
        vendor_dashboard: "विक्रेता डॅशबोर्ड",
        supplier_dashboard: "पुरवठादार डॅशबोर्ड",
        refresh: "रीफ्रेश करा",
        logout: "लॉगआउट करा",
        inventory_status: "इन्वेंटरी स्थिती",
        update_inventory: "इन्वेंटरी अपडेट करा",
        product: "उत्पाद",
        quantity: "प्रमाण",
        status: "स्थिती",
        actions: "कृती",
        price_comparison: "किंमत तुलना",
        item: "वस्तू",
        market_price: "बाजारातील किंमत",
        best_supplier: "सर्वोत्तम पुरवठादार",
        best_price: "सर्वोत्तम किंमत",
        nearby_suppliers: "जवळचे पुरवठादार",
        notifications: "सूचना",
        group_purchases: "समूह खरेदी",
        join: "सामील व्हा",
        autopay_setup: "ऑटोपे सेटअप",
        payment_methods: "पेमेंट पद्धती",
        bank_transfer: "बँक ट्रान्सफर",
        credit_card: "क्रेडिट कार्ड",
        upi: "युपीआय",
        autopay_settings: "ऑटोपे सेटिंग्स",
        min_amount: "किमान ऑर्डर रक्कम",
        payment_day: "पेमेंट दिवस",
        first_day: "महिन्याचा पहिला दिवस",
        fifteenth_day: "महिन्याचा १५ वा दिवस",
        last_day: "महिन्याचा शेवटचा दिवस",
        product_catalog: "उत्पादन सूची",
        add_product: "उत्पाद जोडा",
        price: "किंमत (₹/किलो)",
        freshness: "ताजेपणा",
        hygiene_rating: "स्वच्छता रेटिंग",
        reviews: "समीक्षा आणि रेटिंग",
        total_reviews: "एकूण समीक्षा",
        vendor_orders: "विक्रेता ऑर्डर",
        pending: "प्रलंबित",
        fulfilled: "पूर्ण केलेले",
        group_orders: "समूह ऑर्डर",
        vendor_name: "विक्रेता नाव",
        items: "वस्तू",
        amount: "रक्कम",
        order_date: "ऑर्डर तारीख",
        delivery_date: "वितरण तारीख",
        profile: "प्रोफाइल आणि व्यवसाय तपशील",
        business_name: "व्यवसाय नाव",
        contact_number: "संपर्क क्रमांक",
        delivery_areas: "वितरण क्षेत्रे",
        business_hours: "व्यवसायाचे तास",
        hygiene_practices: "स्वच्छता पद्धती",
        update_profile: "प्रोफाइल अपडेट करा",
        add_new_product: "नवीन उत्पाद जोडा",
        product_name: "उत्पादाचे नाव",
        price_per_kg: "प्रति किलो किंमत (₹)",
        fresh: "ताजे (< २४ तास)",
        good: "चांगले (१-३ दिवस)",
        regular: "नियमित (३-७ दिवस)",
        available_quantity: "उपलब्ध प्रमाण (किलो)",
        cancel: "रद्द करा",
        save_product: "उत्पाद जतन करा",
        low_stock: "कमी स्टॉक",
        ok_stock: "ठीक आहे",
        order: "ऑर्डर",
        distance: "अंतर",
        view_products: "उत्पादे पहा",
        price_drop: "किंमत कमी",
        new_supplier_offer: "नवीन पुरवठादार ऑफर",
        govt_scheme: "सरकारी योजना",
        items_needed: "आवश्यक वस्तू",
        vendors_joined: "सामील झालेले विक्रेते",
        join_group: "समूहात सामील व्हा",
        verify: "सत्यापित करा",
        fulfill: "पूर्ण करा",
        complete: "पूर्ण",
        review_from: "कडून समीक्षा",
        days_ago: "दिवसांपूर्वी",
        group_purchase_opportunity: "समूह खरेदी संधी",
        ordered_on: "वर ऑर्डर केले",
        delivered_on: "वर वितरित",
        delivery_pending: "वितरण प्रलंबित",
        new_order: "नवीन ऑर्डर",
        repeat_order: "पुन्हा ऑर्डर",
        vendor_comment: "विक्रेता टिप्पणी",
        add_to_cart: "कार्टमध्ये जोडा",
        buy_now: "आता खरेदी करा"
    }
};

// Mock data
const mockData = {
    vendors: [
        { id: 1, name: "Rajesh", business: "Rajesh Pav Bhaji", location: "Dadar" },
        { id: 2, name: "Anita", business: "Anita's Chaat Corner", location: "Bandra" },
        { id: 3, name: "Prakash", business: "Prakash Vada Pav", location: "Andheri" }
    ],
    suppliers: [
        {
            id: 1,
            name: "Ganesh Trading Co.",
            location: "Dadar",
            distance: "1.2 km",
            rating: 4.7,
            category: "Vegetables, Spices",
            products: [
                { name: "Potato", price: 35, freshness: "Fresh", hygieneRating: 5 },
                { name: "Tomato", price: 60, freshness: "Fresh", hygieneRating: 5 },
                { name: "Onion", price: 40, freshness: "Good", hygieneRating: 4 }
            ]
        },
        {
            id: 2,
            name: "Mumbai Masala Supply",
            location: "Andheri",
            distance: "3.5 km",
            rating: 4.3,
            category: "Spices, Flours",
            products: [
                { name: "Red Chili Powder", price: 320, freshness: "Good", hygieneRating: 4 },
                { name: "Turmeric Powder", price: 280, freshness: "Good", hygieneRating: 4 },
                { name: "Coriander Powder", price: 220, freshness: "Regular", hygieneRating: 3 }
            ]
        },
        {
            id: 3,
            name: "Fresh Veggie Hub",
            location: "Bandra",
            distance: "2.8 km",
            rating: 4.5,
            category: "Vegetables, Fruits",
            products: [
                { name: "Capsicum", price: 70, freshness: "Fresh", hygieneRating: 5 },
                { name: "Cauliflower", price: 50, freshness: "Fresh", hygieneRating: 4 },
                { name: "Peas", price: 120, freshness: "Fresh", hygieneRating: 5 }
            ]
        }
    ],
    vendorInventory: [
        { name: "Potato", quantity: 8, status: "low" },
        { name: "Tomato", quantity: 12, status: "ok" },
        { name: "Onion", quantity: 15, status: "ok" },
        { name: "Butter", quantity: 5, status: "low" },
        { name: "Pav", quantity: 50, status: "ok" },
        { name: "Coriander", quantity: 2, status: "low" }
    ],
    priceComparison: [
        { item: "Potato", marketPrice: 40, bestSupplier: "Ganesh Trading Co.", bestPrice: 35 },
        { item: "Tomato", marketPrice: 70, bestSupplier: "Fresh Veggie Hub", bestPrice: 65 },
        { item: "Onion", marketPrice: 45, bestSupplier: "Ganesh Trading Co.", bestPrice: 40 },
        { item: "Red Chili Powder", marketPrice: 350, bestSupplier: "Mumbai Masala Supply", bestPrice: 320 },
        { item: "Butter", marketPrice: 580, bestSupplier: "Amul Distributor", bestPrice: 560 }
    ],
    vendorNotifications: [
        { type: "price_drop", title: "Price Drop", message: "Potato prices reduced by 10% at Ganesh Trading Co.", time: "1 hour ago" },
        { type: "new_supplier", title: "New Supplier", message: "New supplier 'Fresh Produce' added near your location.", time: "3 hours ago" },
        { type: "govt_scheme", title: "Govt. Scheme", message: "New subsidy available for street food vendors. Apply before 30th.", time: "1 day ago" }
    ],
    groupPurchases: [
        {
            id: 1,
            items: ["Potato", "Onion", "Tomato"],
            totalQuantity: 150,
            bestSupplier: "Ganesh Trading Co.",
            discount: "15%",
            vendorsJoined: 5,
            deadline: "Today, 6 PM"
        },
        {
            id: 2,
            items: ["Red Chili Powder", "Turmeric Powder", "Garam Masala"],
            totalQuantity: 30,
            bestSupplier: "Mumbai Masala Supply",
            discount: "10%",
            vendorsJoined: 8,
            deadline: "Tomorrow, 12 PM"
        }
    ],
    supplierProducts: [
        { name: "Potato", price: 35, freshness: "Fresh", hygieneRating: 5, quantity: 200 },
        { name: "Tomato", price: 60, freshness: "Fresh", hygieneRating: 5, quantity: 150 },
        { name: "Onion", price: 40, freshness: "Good", hygieneRating: 4, quantity: 300 },
        { name: "Capsicum", price: 75, freshness: "Fresh", hygieneRating: 5, quantity: 100 },
        { name: "Ginger", price: 120, freshness: "Good", hygieneRating: 4, quantity: 80 }
    ],
    pendingOrders: [
        { vendor: "Rajesh", items: "Potato, Onion, Tomato", quantity: "10kg, 5kg, 8kg", date: "Today, 10:30 AM" },
        { vendor: "Anita", items: "Capsicum, Ginger", quantity: "3kg, 1kg", date: "Today, 11:45 AM" }
    ],
    fulfilledOrders: [
        { vendor: "Prakash", items: "Potato, Onion", amount: "₹850", deliveryDate: "Yesterday", status: "Delivered" },
        { vendor: "Rajesh", items: "Tomato, Capsicum", amount: "₹1,350", deliveryDate: "Oct 15, 2023", status: "Delivered" }
    ],
    groupOrders: [
        {
            id: 1,
            title: "Bulk Vegetable Order",
            items: ["Potato (150kg)", "Onion (100kg)", "Tomato (80kg)"],
            vendors: ["Rajesh", "Anita", "Prakash", "+3 more"],
            totalAmount: "₹15,200",
            status: "Processing",
            deadline: "Today, 4 PM"
        }
    ],
    reviews: [
        { name: "Rajesh", rating: 5, text: "Excellent quality vegetables, always fresh.", date: "3 days ago" },
        { name: "Anita", rating: 4, text: "Good service and timely delivery.", date: "1 week ago" },
        { name: "Prakash", rating: 5, text: "Best supplier in the area. Never disappoints.", date: "2 weeks ago" },
        { name: "Sanjay", rating: 4, text: "Quality products at reasonable prices.", date: "2 weeks ago" },
        { name: "Meera", rating: 5, text: "Very reliable and consistent quality.", date: "3 weeks ago" }
    ],
    supplierNotifications: [
        { type: "new_order", title: "New Order", message: "Rajesh placed a new order worth ₹950.", time: "30 min ago" },
        { type: "group_order", title: "Group Order", message: "New group purchase request for vegetables from 5 vendors.", time: "2 hours ago" },
        { type: "vendor_comment", title: "Vendor Comment", message: "Anita: 'The tomatoes were exceptionally good this time!'", time: "1 day ago" }
    ]
};

// Current language
let currentLang = "en";

// Initialize the application
$(document).ready(function () {
    // Setup language switcher
    setupLanguageSwitcher();

    // Setup login form
    setupLoginForm();

    // Load data from localStorage if exists
    loadFromLocalStorage();

    // Setup form submissions and button actions
    setupEventListeners();

    // Initialize Popovers and Tooltips
    initBootstrapComponents();
});

// Language switcher function
function setupLanguageSwitcher() {
    $(".lang-btn").click(function () {
        currentLang = $(this).data("lang");
        $(".lang-btn").removeClass("active");
        $(this).addClass("active");
        updateLanguage();

        // Save language preference
        localStorage.setItem("vendorconnect_lang", currentLang);
    });

    // Load saved language preference
    const savedLang = localStorage.getItem("vendorconnect_lang");
    if (savedLang) {
        currentLang = savedLang;
        $(`.lang-btn[data-lang="${currentLang}"]`).click();
    }
}

// Update all text content based on selected language
function updateLanguage() {
    $("[data-i18n]").each(function () {
        const key = $(this).data("i18n");
        if (translations[currentLang] && translations[currentLang][key]) {
            $(this).text(translations[currentLang][key]);
        }
    });
}

// Setup login form
function setupLoginForm() {
    $("#login-form").submit(function (e) {
        e.preventDefault();

        const username = $("#username").val();
        const password = $("#password").val();
        const role = $("#role").val();

        // Simple validation
        if (!username || !password || !role) {
            alert("Please fill in all fields");
            return;
        }

        // Save user data
        const userData = { username, role };
        localStorage.setItem("vendorconnect_user", JSON.stringify(userData));

        // Show appropriate dashboard
        $("#login-section").hide();
        if (role === "vendor") {
            showVendorDashboard(username);
        } else {
            showSupplierDashboard(username);
        }
    });
}

// Load data from localStorage
function loadFromLocalStorage() {
    const userData = JSON.parse(localStorage.getItem("vendorconnect_user"));
    if (userData) {
        $("#login-section").hide();
        if (userData.role === "vendor") {
            showVendorDashboard(userData.username);
        } else {
            showSupplierDashboard(userData.username);
        }
    }
}

// Setup event listeners
function setupEventListeners() {
    // Logout buttons
    $("#logout-btn, #supplier-logout-btn").click(function () {
        localStorage.removeItem("vendorconnect_user");
        $("#vendor-dashboard, #supplier-dashboard").hide();
        $("#login-section").show();
        $("#login-form")[0].reset();
    });

    // Refresh data buttons
    $("#refresh-data, #supplier-refresh-data").click(function () {
        location.reload();
    });

    // Autopay slider value display
    $("#min-amount").on("input", function () {
        $("#min-amount-value").text(`₹${$(this).val()}`);
    });

    // Save product button
    $("#save-product").click(function () {
        const productName = $("#product-name").val();
        const productPrice = $("#product-price").val();
        const productFreshness = $("#product-freshness").val();
        const hygieneRating = $("#hygiene-rating").val();
        const availableQuantity = $("#available-quantity").val();

        // Validate inputs
        if (!productName || !productPrice || !productFreshness || !hygieneRating || !availableQuantity) {
            alert("Please fill all fields");
            return;
        }

        // Add product to the list (in a real app, this would be sent to a server)
        mockData.supplierProducts.push({
            name: productName,
            price: parseInt(productPrice),
            freshness: productFreshness,
            hygieneRating: parseInt(hygieneRating),
            quantity: parseInt(availableQuantity)
        });

        // Update the product table
        updateSupplierProductsTable();

        // Close the modal
        $("#addProductModal").modal("hide");

        // Reset the form
        $("#add-product-form")[0].reset();
    });

    // Supplier profile form
    $("#supplier-profile-form").submit(function (e) {
        e.preventDefault();
        alert("Profile updated successfully!");
    });
}

// Initialize Bootstrap components
function initBootstrapComponents() {
    // Initialize any Bootstrap components if needed
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    });
}

// Show Vendor Dashboard
function showVendorDashboard(username) {
    $("#vendor-dashboard").show();
    $("#vendor-name").text(username);

    // Load vendor dashboard data
    loadVendorInventory();
    loadPriceComparison();
    loadSuppliersList();
    loadVendorNotifications();
    loadGroupPurchases();

    // Initialize price comparison chart
    initPriceComparisonChart();
}

// Show Supplier Dashboard
function showSupplierDashboard(username) {
    $("#supplier-dashboard").show();
    $("#supplier-name").text(username);

    // Load supplier dashboard data
    updateSupplierProductsTable();
    loadPendingOrders();
    loadFulfilledOrders();
    loadGroupOrdersList();
    loadReviews();
    loadSupplierNotifications();
}

// Load vendor inventory
function loadVendorInventory() {
    const inventoryTable = $("#vendor-inventory-table tbody");
    inventoryTable.empty();

    mockData.vendorInventory.forEach(item => {
        const statusClass = item.status === "low" ? "stock-low" : "stock-ok";
        const statusText = item.status === "low" ?
            translations[currentLang].low_stock :
            translations[currentLang].ok_stock;

        inventoryTable.append(`
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.quantity} kg</td>
                        <td><span class="${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary">
                                ${translations[currentLang].order}
                            </button>
                        </td>
                    </tr>
                `);
    });
}

// Load price comparison
function loadPriceComparison() {
    const priceTable = $("#price-comparison-table tbody");
    priceTable.empty();

    mockData.priceComparison.forEach(item => {
        const savings = item.marketPrice - item.bestPrice;
        const savingsPercent = Math.round((savings / item.marketPrice) * 100);

        priceTable.append(`
                    <tr>
                        <td>${item.item}</td>
                        <td>₹${item.marketPrice}</td>
                        <td>${item.bestSupplier}</td>
                        <td>₹${item.bestPrice} <span class="text-success">(-${savingsPercent}%)</span></td>
                    </tr>
                `);
    });
}

// Load suppliers list
function loadSuppliersList() {
    const suppliersList = $("#suppliers-list");
    suppliersList.empty();

    mockData.suppliers.forEach(supplier => {
        const starsHTML = getStarsHTML(supplier.rating);

        suppliersList.append(`
                    <div class="col-md-6 mb-3">
                        <div class="supplier-item p-3 bg-white rounded">
                            <h5>${supplier.name}</h5>
                            <div class="d-flex align-items-center mb-2">
                                <div class="stars me-2">${starsHTML}</div>
                                <span>${supplier.rating}</span>
                            </div>
                            <p class="mb-1"><i class="fas fa-map-marker-alt me-2"></i> ${supplier.location} (${supplier.distance})</p>
                            <p class="mb-2"><i class="fas fa-tag me-2"></i> ${supplier.category}</p>
                            <button class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-eye me-1"></i> ${translations[currentLang].view_products}
                            </button>
                        </div>
                    </div>
                `);
    });
}

// Load vendor notifications
function loadVendorNotifications() {
    const notificationsDiv = $("#vendor-notifications");
    notificationsDiv.empty();

    mockData.vendorNotifications.forEach(notification => {
        let icon = "fa-bell";
        if (notification.type === "price_drop") icon = "fa-tags";
        if (notification.type === "new_supplier") icon = "fa-store";
        if (notification.type === "govt_scheme") icon = "fa-landmark";

        notificationsDiv.append(`
                    <div class="notification-item">
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <i class="fas ${icon} fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">${translations[currentLang][notification.type]}</h6>
                                <p class="mb-0">${notification.message}</p>
                                <small class="text-muted">${notification.time}</small>
                            </div>
                        </div>
                    </div>
                `);
    });
}

// Load group purchases
function loadGroupPurchases() {
    const groupPurchasesDiv = $("#group-purchases");
    groupPurchasesDiv.empty();

    mockData.groupPurchases.forEach(purchase => {
        groupPurchasesDiv.append(`
                    <div class="group-purchase-item mb-3">
                        <h5 class="mb-2">${translations[currentLang].group_purchase_opportunity}</h5>
                        <p class="mb-1"><strong>${translations[currentLang].items_needed}:</strong> ${purchase.items.join(", ")}</p>
                        <p class="mb-1"><strong>${translations[currentLang].vendors_joined}:</strong> ${purchase.vendorsJoined}</p>
                        <p class="mb-1"><strong>${translations[currentLang].best_supplier}:</strong> ${purchase.bestSupplier}</p>
                        <p class="mb-2"><strong>${translations[currentLang].discount}:</strong> ${purchase.discount}</p>
                        <div class="d-flex align-items-center justify-content-between">
                            <small class="text-danger"><i class="far fa-clock me-1"></i> ${purchase.deadline}</small>
                            <button class="btn btn-sm btn-primary">
                                ${translations[currentLang].join_group}
                            </button>
                        </div>
                    </div>
                `);
    });
}

// Update supplier products table
function updateSupplierProductsTable() {
    const productsTable = $("#supplier-products-table tbody");
    productsTable.empty();

    mockData.supplierProducts.forEach(product => {
        const freshnessClass = product.freshness === "Fresh" ? "success" :
            (product.freshness === "Good" ? "info" : "warning");

        productsTable.append(`
                    <tr>
                        <td>${product.name}</td>
                        <td>₹${product.price}</td>
                        <td>
                            <span class="badge bg-${freshnessClass} freshness-tag">
                                ${product.freshness}
                            </span>
                        </td>
                        <td>${getStarsHTML(product.hygieneRating)}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-secondary me-1">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `);
    });
}

// Load pending orders
function loadPendingOrders() {
    const ordersTable = $("#pending-orders-table tbody");
    ordersTable.empty();

    mockData.pendingOrders.forEach(order => {
        ordersTable.append(`
                    <tr>
                        <td>${order.vendor}</td>
                        <td>${order.items}</td>
                        <td>${order.quantity}</td>
                        <td>${order.date}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-info me-1">
                                ${translations[currentLang].verify}
                            </button>
                            <button class="btn btn-sm btn-outline-success">
                                ${translations[currentLang].fulfill}
                            </button>
                        </td>
                    </tr>
                `);
    });
}

// Load fulfilled orders
function loadFulfilledOrders() {
    const ordersTable = $("#fulfilled-orders-table tbody");
    ordersTable.empty();

    mockData.fulfilledOrders.forEach(order => {
        const statusClass = order.status === "Delivered" ? "success" : "warning";

        ordersTable.append(`
                    <tr>
                        <td>${order.vendor}</td>
                        <td>${order.items}</td>
                        <td>${order.amount}</td>
                        <td>${order.deliveryDate}</td>
                        <td><span class="badge bg-${statusClass}">${order.status}</span></td>
                    </tr>
                `);
    });
}

// Load group orders list
function loadGroupOrdersList() {
    const groupOrdersList = $("#group-orders-list");
    groupOrdersList.empty();

    mockData.groupOrders.forEach(order => {
        const itemsList = order.items.map(item => `<li>${item}</li>`).join("");

        groupOrdersList.append(`
                    <div class="card mb-3">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <strong>${order.title}</strong>
                            <span class="badge bg-primary">${order.status}</span>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="mb-1"><strong>${translations[currentLang].items}:</strong></p>
                                    <ul class="ps-3">
                                        ${itemsList}
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-1"><strong>${translations[currentLang].vendors}:</strong> ${order.vendors.join(", ")}</p>
                                    <p class="mb-1"><strong>${translations[currentLang].total_amount}:</strong> ${order.totalAmount}</p>
                                    <p class="mb-3"><strong>${translations[currentLang].deadline}:</strong> ${order.deadline}</p>
                                    <button class="btn btn-sm btn-success">
                                        ${translations[currentLang].complete}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
    });
}

// Load reviews
function loadReviews() {
    const reviewsDiv = $("#recent-reviews");
    reviewsDiv.empty();

    mockData.reviews.forEach(review => {
        reviewsDiv.append(`
                    <div class="review-item mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <strong>${translations[currentLang].review_from} ${review.name}</strong>
                            <div class="stars">${getStarsHTML(review.rating)}</div>
                        </div>
                        <p class="mb-1">${review.text}</p>
                        <small class="text-muted">${review.date}</small>
                    </div>
                `);
    });
}

// Load supplier notifications
function loadSupplierNotifications() {
    const notificationsDiv = $("#supplier-notifications");
    notificationsDiv.empty();

    mockData.supplierNotifications.forEach(notification => {
        let icon = "fa-bell";
        if (notification.type === "new_order") icon = "fa-shopping-bag";
        if (notification.type === "group_order") icon = "fa-users";
        if (notification.type === "vendor_comment") icon = "fa-comment";

        notificationsDiv.append(`
                    <div class="notification-item">
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <i class="fas ${icon} fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">${translations[currentLang][notification.type]}</h6>
                                <p class="mb-0">${notification.message}</p>
                                <small class="text-muted">${notification.time}</small>
                            </div>
                        </div>
                    </div>
                `);
    });
}

// Helper function to generate HTML for star ratings
function getStarsHTML(rating) {
    let starsHTML = "";
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;

    // Add full stars
    for (let i = 0; i < fullStars; i++) {
        starsHTML += '<i class="fas fa-star"></i> ';
    }

    // Add half star if needed
    if (hasHalfStar) {
        starsHTML += '<i class="fas fa-star-half-alt"></i> ';
    }

    // Add empty stars
    const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
    for (let i = 0; i < emptyStars; i++) {
        starsHTML += '<i class="far fa-star"></i> ';
    }

    return starsHTML;
}

// Initialize price comparison chart
function initPriceComparisonChart() {
    const ctx = document.getElementById('priceComparisonChart').getContext('2d');

    // Prepare data from mockData
    const items = mockData.priceComparison.map(item => item.item);
    const marketPrices = mockData.priceComparison.map(item => item.marketPrice);
    const bestPrices = mockData.priceComparison.map(item => item.bestPrice);

    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: items,
            datasets: [
                {
                    label: 'Market Price',
                    backgroundColor: '#FF9E68',
                    data: marketPrices
                },
                {
                    label: 'Best Supplier Price',
                    backgroundColor: '#2EC4B6',
                    data: bestPrices
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Price Comparison (₹ per kg/unit)'
                },
                legend: {
                    position: 'bottom'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Price (₹)'
                    }
                }
            }
        }
    });}
